<config-template 
  xmlns="http://tail-f.com/ns/config/1.0">
  <devices 
    xmlns="http://tail-f.com/ns/ncs">
    <device>
      <name>{/device}</name>
      <config>
        <!-- IOS XR CONFIG -->
        <vrf 
          xmlns="http://tail-f.com/ned/cisco-ios-xr">
          <vrf-list>
            <name>{/vrf-name}</name>
            <address-family>
              <ipv4>
                <unicast>
                  <import>
                    <route-target>
                      <address-list>
                        <name>{/local-as-number}:101</name>
                      </address-list>
                      <address-list>
                        <name>{/local-as-number}:{/route-target}</name>
                      </address-list>
                    </route-target>
                  </import>
                  <export>
                    <route-policy>MTNNS-VRF-MGNT</route-policy>
                    <route-target>
                      <address-list>
                        <name>{/local-as-number}:{/route-target}</name>
                      </address-list>
                    </route-target>
                  </export>
                  <maximum>
                    <prefix>
                      <limit>{/max-prefix}</limit>
                      <mid-thresh>80</mid-thresh>
                    </prefix>
                  </maximum>
                </unicast>
              </ipv4>
            </address-family>
          </vrf-list>
        </vrf>
        <router 
          xmlns="http://tail-f.com/ned/cisco-ios-xr">
          <bgp>
            <bgp-no-instance>
              <id>{/local-as-number}</id>
              <vrf>
                <name>VRF-{/vrf-name}</name>
                <rd>{/local-as-number}:{$DERIVED_RD}</rd>
                <label>
                  <mode>per-vrf</mode>
                </label>
                <address-family>
                  <ipv4>
                    <unicast>
                      <redistribute>
                        <connected>
                          <route-policy>VRF-CONN-TO-BGP-{/local-preference}</route-policy>
                        </connected>
                        <static>
                          <route-policy>VRF-CONN-TO-BGP-{/local-preference}</route-policy>
                        </static>
                      </redistribute>
                    </unicast>
                  </ipv4>
                </address-family>
              </vrf>
            </bgp-no-instance>
          </bgp>
        </router>
      </config>
    </device>
  </devices>
</config-template>